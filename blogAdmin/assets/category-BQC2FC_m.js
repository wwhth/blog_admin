import{d as L,r as d,D as O,a as B,c as D,g as a,h as s,E as T,x as U,j as p,B as m,k as $,l as z,n as I,p as V,o as A,G as R,u as M,y as N,A as S,C as F,_ as j}from"./index-C35omCHH.js";import{c as G,e as _,u as q,g as E,d as H}from"./mitt-Dt73_5aZ.js";/* empty css                     */const J={class:"dialog-footer"},K=L({__name:"index",props:{addOrUpdate:{type:Boolean}},setup(k,{expose:g}){const y=k,n=d(!1),f=d(null),t=d(!1),l=O({name:""}),v=()=>{n.value=!0},h=()=>{n.value=!1,l.name=""},C=()=>{n.value=!1},b=async()=>{if(l.name===""){m({message:"请输入类别",type:"error"});return}if(t.value=!0,y.addOrUpdate){const{code:c,message:e}=await G(l);c===200?(m({message:e,type:"success"}),t.value=!1,n.value=!1,_.emit("refreshCategoryList")):(m({message:e,type:"error"}),t.value=!1)}else{const{code:c,message:e}=await q({id:f.value,name:l.name});c===200?(m({message:e,type:"success"}),t.value=!1,n.value=!1,_.emit("refreshCategoryList")):(m({message:e,type:"error"}),t.value=!1)}};return g({visible:n,open:v,formLabelAlign:l,categoryId:f}),(c,e)=>{const r=$,o=z,i=I,u=V,x=T;return B(),D("div",null,[a(x,{title:c.addOrUpdate?"添加类别":"修改类别",width:"600px",modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=w=>n.value=w),onClose:h},{default:s(()=>[a(i,{"label-position":"right","label-width":"auto",model:l,style:{"max-width":"600px"}},{default:s(()=>[a(o,{label:"类别",prop:"name"},{default:s(()=>[a(r,{modelValue:l.name,"onUpdate:modelValue":e[0]||(e[0]=w=>l.name=w)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),footer:s(()=>[U("span",J,[a(u,{size:"small",onClick:C},{default:s(()=>[p("取 消")]),_:1}),a(u,{size:"small",type:"primary",onClick:b,loading:t.value},{default:s(()=>[p("确 定")]),_:1},8,["loading"])])]),_:1},8,["title","modelValue"])])}}}),P={class:"addLabel"},Q=L({__name:"category",setup(k){const g=d(),y=d([]),n=d([]),f=d([]),t=d(),l=d(!0),v=e=>{y.value=e},h=(e,r)=>{var o;t.value.formLabelAlign.name=r.name,l.value=!1,t.value.categoryId=r.id,(o=t.value)==null||o.open(),console.log(e,r)},C=(e,r)=>{S({title:"提示",message:"确定删除这个类别吗?",confirmButtonText:"确定",cancelButtonText:"取消",showCancelButton:!0,type:"warning"}).then(async()=>{const{code:o,message:i}=await H(r.id);o===200?(m({type:"success",message:i}),c()):m({type:"error",message:i})}).catch(o=>{console.log("🚀 ~ handleDelete ~ err:",o)})},b=()=>{l.value=!0,t.value.visible=!0},c=async()=>{const{data:e}=await E();console.log("🚀 ~ onLoad ~ categoriesData:",e),f.value=e;const{data:r}=await E();n.value=r};return A(async()=>{_.on("refreshCategoryList",()=>{c()}),await c()}),R(()=>{_.off("refreshCategoryList")}),(e,r)=>{const o=V,i=F;return B(),D("div",null,[U("div",P,[a(o,{size:"large",onClick:b},{default:s(()=>[p(" 添加类别 ")]),_:1})]),a(M(N),{ref_key:"multipleTableRef",ref:g,data:n.value,style:{width:"100%"},onSelectionChange:v},{default:s(()=>[a(i,{type:"selection",width:"55"}),a(i,{property:"name",label:"类别"}),a(i,{label:"操作",width:"220"},{default:s(u=>[a(o,{size:"small",onClick:x=>h(u.$index,u.row)},{default:s(()=>[p(" 编辑 ")]),_:2},1032,["onClick"]),a(o,{size:"small",type:"danger",onClick:x=>C(u.$index,u.row)},{default:s(()=>[p(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),a(K,{ref_key:"categoryDialogRef",ref:t,addOrUpdate:l.value},null,8,["addOrUpdate"])])}}}),Z=j(Q,[["__scopeId","data-v-2a4a4bed"]]);export{Z as default};
