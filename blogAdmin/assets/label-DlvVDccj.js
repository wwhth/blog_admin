import{d as B,r as i,D as I,o as D,a as v,c as w,g as a,h as o,E as F,F as U,i as R,x as O,j as _,B as m,k as S,l as M,m as N,n as j,p as T,q,v as G,G as H,u as J,y as K,A as P,C as Q,_ as W}from"./index-C35omCHH.js";import{g as $,e as f}from"./mitt-Dt73_5aZ.js";/* empty css                     */import{a as X,u as Y,g as Z,d as ee}from"./label-Dwwfwi5b.js";const ae={class:"dialog-footer"},le=B({__name:"index",props:{addOrUpdate:{type:Boolean}},setup(E,{expose:y}){const h=E,s=i(!1),g=i(null),c=i([]),d=i(!1),t=I({name:"",category_id:null}),L=()=>{s.value=!0},x=()=>{s.value=!1,t.name="",t.category_id=null},C=()=>{s.value=!1},b=async()=>{if(t.name===""||t.category_id===null){m({message:"请输入标签名称和类别",type:"error"});return}if(d.value=!0,h.addOrUpdate){const{code:l,message:e}=await X(t);l===200?(m({message:e,type:"success"}),d.value=!1,s.value=!1,f.emit("refreshLabelList")):(m({message:e,type:"error"}),d.value=!1)}else{const{code:l,message:e}=await Y({id:g.value,name:t.name,category_id:t.category_id});l===200?(m({message:e,type:"success"}),d.value=!1,s.value=!1,f.emit("refreshLabelList")):(m({message:e,type:"error"}),d.value=!1)}};return D(async()=>{const{data:l}=await $();c.value=l}),y({visible:s,open:L,formLabelAlign:t,labelId:g}),(l,e)=>{const n=S,r=M,p=G,k=N,z=j,V=T,A=F;return v(),w("div",null,[a(A,{title:l.addOrUpdate?"添加标签":"修改标签",width:"600px",modelValue:s.value,"onUpdate:modelValue":e[2]||(e[2]=u=>s.value=u),onClose:x},{default:o(()=>[a(z,{"label-position":"right","label-width":"auto",model:t,style:{"max-width":"600px"}},{default:o(()=>[a(r,{label:"标签",prop:"name"},{default:o(()=>[a(n,{modelValue:t.name,"onUpdate:modelValue":e[0]||(e[0]=u=>t.name=u)},null,8,["modelValue"])]),_:1}),a(r,{label:"类别",prop:"category_id"},{default:o(()=>[a(k,{modelValue:t.category_id,"onUpdate:modelValue":e[1]||(e[1]=u=>t.category_id=u),placeholder:"请选择标签类别"},{default:o(()=>[(v(!0),w(U,null,R(c.value,u=>(v(),q(p,{key:u.id,label:u.name,value:u.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),footer:o(()=>[O("span",ae,[a(V,{size:"small",onClick:C},{default:o(()=>[_("取 消")]),_:1}),a(V,{size:"small",type:"primary",onClick:b,loading:d.value},{default:o(()=>[_("确 定")]),_:1},8,["loading"])])]),_:1},8,["title","modelValue"])])}}}),te={class:"addLabel"},oe=B({__name:"label",setup(E){const y=i(),h=i([]),s=i([]),g=i([]),c=i(),d=i(!0),t=l=>{h.value=l},L=(l,e)=>{var n;c.value.formLabelAlign.name=e.name,c.value.formLabelAlign.category_id=e.category_id,c.value.labelId=e.id,d.value=!1,(n=c.value)==null||n.open(),console.log(l,e)},x=(l,e)=>{P({title:"提示",message:"确定删除这个标签吗?",confirmButtonText:"确定",cancelButtonText:"取消",showCancelButton:!0,type:"warning"}).then(async()=>{const{code:n,message:r}=await ee(e.id);n===200?(m({type:"success",message:r}),f.emit("refreshLabelList")):m({type:"error",message:r})}).catch(n=>{console.log("🚀 ~ handleDelete ~ err:",n)})},C=()=>{d.value=!0,c.value.visible=!0},b=async()=>{const{data:l}=await $();console.log("🚀 ~ onLoad ~ categoriesData:",l),g.value=l;const{data:e}=await Z();s.value=e};return D(async()=>{f.on("refreshLabelList",()=>{b()}),await b()}),H(()=>{f.off("refreshLabelList")}),(l,e)=>{const n=T,r=Q;return v(),w(U,null,[O("div",te,[a(n,{size:"large",onClick:C},{default:o(()=>[_(" 添加标签 ")]),_:1})]),a(J(K),{ref_key:"multipleTableRef",ref:y,data:s.value,style:{width:"100%"},onSelectionChange:t},{default:o(()=>[a(r,{type:"selection",width:"55"}),a(r,{property:"name",label:"标签",width:"120"}),a(r,{property:"category",label:"类别"}),a(r,{label:"操作"},{default:o(p=>[a(n,{size:"small",onClick:k=>L(p.$index,p.row)},{default:o(()=>[_(" 编辑 ")]),_:2},1032,["onClick"]),a(n,{size:"small",type:"danger",onClick:k=>x(p.$index,p.row)},{default:o(()=>[_(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),a(le,{ref_key:"labelDialogRef",ref:c,addOrUpdate:d.value},null,8,["addOrUpdate"])],64)}}}),ie=W(oe,[["__scopeId","data-v-1a738c15"]]);export{ie as default};
